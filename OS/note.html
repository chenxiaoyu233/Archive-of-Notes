<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2019-04-24 Wed 21:48 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>&lrm;</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="陈小羽" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { width: 90%; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/styles/readtheorg/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/styles/readtheorg/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/styles/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/styles/readtheorg/js/readtheorg.js"></script>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2018 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org3b2f79a">1. 操作系统的目标与功能</a>
<ul>
<li><a href="#org4b710cd">1.1. 定义</a></li>
<li><a href="#org2a9499d">1.2. 目标</a></li>
<li><a href="#org6e784eb">1.3. 基本功能/提供的服务</a></li>
</ul>
</li>
<li><a href="#orga0649c7">2. 操作系统的发展过程</a>
<ul>
<li><a href="#org646c964">2.1. 串行处理</a></li>
<li><a href="#orgfc223c1">2.2. 简单批处理系统</a></li>
<li><a href="#orgd0b69f7">2.3. 多道批处理系统</a>
<ul>
<li><a href="#org3cfbea3">2.3.1. 并发 vs 并行</a></li>
</ul>
</li>
<li><a href="#org08b6545">2.4. 分时系统</a></li>
<li><a href="#org59c405f">2.5. 实时系统</a></li>
</ul>
</li>
<li><a href="#orgef02439">3. 操作系统的主要成就</a></li>
<li><a href="#orgeb106f1">4. 操作系统的基本特征</a>
<ul>
<li><a href="#org51dc20b">4.1. 并发性</a>
<ul>
<li><a href="#org29fd8c7">4.1.1. 并发 vs 并行</a></li>
</ul>
</li>
<li><a href="#org623ca02">4.2. 共享</a></li>
<li><a href="#org045ca48">4.3. 虚拟性</a></li>
<li><a href="#orgcb24915">4.4. 异步性(不确定性)</a></li>
</ul>
</li>
<li><a href="#orgc9b719a">5. 操作系统的体系结构</a>
<ul>
<li><a href="#org07ec66a">5.1. 层次化</a></li>
<li><a href="#org8ca043a">5.2. 单体内核</a></li>
<li><a href="#org4e4258d">5.3. 微内核</a></li>
<li><a href="#org2bd54cd">5.4. 模块化</a></li>
</ul>
</li>
<li><a href="#org259e92d">6. 进程定义</a>
<ul>
<li><a href="#org8dfd77b">6.1. 典型的定义</a></li>
<li><a href="#org4291bf0">6.2. 组成</a></li>
<li><a href="#org77a257c">6.3. 基本特征</a></li>
</ul>
</li>
<li><a href="#orgcecac23">7. 进程状态</a>
<ul>
<li><a href="#orgdebd41c">7.1. 进程轨迹(trace)</a></li>
<li><a href="#org25d06a3">7.2. 进程状态</a>
<ul>
<li><a href="#org8526a42">7.2.1. 三状态模型 {就绪, 执行, 阻塞}</a></li>
<li><a href="#org7b78995">7.2.2. 五状态模型 {执行, 阻塞, 就绪, 新建, 终止}</a></li>
<li><a href="#orgcf89950">7.2.3. 考虑挂起进程模型</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgac61181">8. 进程描述</a>
<ul>
<li><a href="#orgd8c207e">8.1. 进程控制结构</a>
<ul>
<li><a href="#org31ee5c6">8.1.1. 进程的物理存在 &#x2013; 进程印像(Process Image)</a></li>
<li><a href="#org66c6577">8.1.2. PCB</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org8d65b54">9. 内核功能和执行模式</a>
<ul>
<li><a href="#orge0dfde3">9.1. 内核功能</a>
<ul>
<li><a href="#org9714ac0">9.1.1. 资源管理功能</a></li>
<li><a href="#org8ffefee">9.1.2. 支撑功能</a></li>
</ul>
</li>
<li><a href="#org3fdcdcd">9.2. 执行模式 {内核, 用户}</a></li>
</ul>
</li>
<li><a href="#org2c3678d">10. 进程控制</a>
<ul>
<li><a href="#orgf6d9988">10.1. 内容</a></li>
<li><a href="#orga9ca4e7">10.2. 实现</a>
<ul>
<li><a href="#org6fd33d3">10.2.1. 原语 (Primitive)</a></li>
</ul>
</li>
<li><a href="#orge53b60e">10.3. Unix 进程控制</a></li>
</ul>
</li>
<li><a href="#org70727b2">11. 线程</a>
<ul>
<li><a href="#orgdf627d6">11.1. 提出</a>
<ul>
<li><a href="#org1f8b293">11.1.1. 区分</a></li>
<li><a href="#org1612631">11.1.2. 一些术语</a></li>
<li><a href="#org2f18935">11.1.3. 例子</a></li>
</ul>
</li>
<li><a href="#orgbe207bb">11.2. 多线程环境, 用到的资源和保护</a></li>
<li><a href="#orgd43225d">11.3. 每个线程的内容</a></li>
<li><a href="#orga141cca">11.4. 线程状态变化的基本操作</a></li>
<li><a href="#org753aa78">11.5. 线程的优点</a></li>
<li><a href="#org5db9c23">11.6. 线程分类</a></li>
</ul>
</li>
<li><a href="#orgb911a20">12. 进程调度</a>
<ul>
<li><a href="#orgd78e730">12.1. 背景</a>
<ul>
<li><a href="#orgb93442d">12.1.1. 定义</a></li>
</ul>
</li>
<li><a href="#org08f248e">12.2. 类型</a>
<ul>
<li><a href="#org1565eb7">12.2.1. 长程调度</a></li>
<li><a href="#orgd1081fe">12.2.2. 中程调度</a></li>
<li><a href="#org3cd7bcb">12.2.3. 短程调度</a></li>
</ul>
</li>
<li><a href="#orgfa01e10">12.3. 概念</a>
<ul>
<li><a href="#orgf55b206">12.3.1. 响应时间</a></li>
<li><a href="#org47cf6f3">12.3.2. 周转时间(驻留时间)</a></li>
<li><a href="#org0cd550f">12.3.3. 截止时间</a></li>
<li><a href="#org3bb4ea8">12.3.4. 系统吞吐量</a></li>
<li><a href="#orga677863">12.3.5. 处理器利用率</a></li>
<li><a href="#org7b06877">12.3.6. 平均周转时间</a></li>
<li><a href="#org43ecfe0">12.3.7. 带权周转时间</a></li>
<li><a href="#orgcfb1497">12.3.8. 平均带权周转时间</a></li>
</ul>
</li>
<li><a href="#org6c6f9ee">12.4. 调度规则设计的出发点</a>
<ul>
<li><a href="#org44f20d3">12.4.1. 分类</a></li>
<li><a href="#org991dcc7">12.4.2. 通过分类来选择优化的目标函数</a></li>
<li><a href="#org5bf8196">12.4.3. 进程的决策模式</a></li>
<li><a href="#orgaad5926">12.4.4. 调度选择函数</a></li>
<li><a href="#org9462e46">12.4.5. 一些调度算法</a></li>
</ul>
</li>
<li><a href="#org4be7dac">12.5. 实时系统与实时调度</a>
<ul>
<li><a href="#org33b4a47">12.5.1. 定义</a></li>
<li><a href="#orgf155ac4">12.5.2. 实时任务分类</a></li>
<li><a href="#org8e85859">12.5.3. 实时操作系统特点</a></li>
<li><a href="#org39ecb8b">12.5.4. 实时进程的抢占方式</a></li>
<li><a href="#org505c382">12.5.5. 实时进程的调度方法分类</a></li>
<li><a href="#orged56721">12.5.6. 限期 (deadline) 调度</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org10efa76">13. 同步</a>
<ul>
<li><a href="#orgfee1e51">13.1. 相关术语</a></li>
<li><a href="#org90da7cc">13.2. 进程间的关系</a></li>
<li><a href="#orge981b32">13.3. 互斥的要求 (访问临界区的原则)</a></li>
<li><a href="#org1769e4d">13.4. 互斥: 软件方法</a>
<ul>
<li><a href="#orge0e0a49">13.4.1. 评价</a></li>
</ul>
</li>
<li><a href="#org4fb6e44">13.5. 互斥: 硬件方法</a>
<ul>
<li><a href="#org3b6c71d">13.5.1. 屏蔽中断</a></li>
<li><a href="#org833642f">13.5.2. 机器专用指令</a></li>
</ul>
</li>
<li><a href="#org5b53a63">13.6. 信号量</a>
<ul>
<li><a href="#org11b378f">13.6.1. 实现</a></li>
<li><a href="#org10b7b14">13.6.2. 常见模型</a></li>
<li><a href="#org5d2bb50">13.6.3. 管程</a></li>
<li><a href="#orgfa9167c">13.6.4. 消息传递</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-org3b2f79a" class="outline-2">
<h2 id="org3b2f79a"><span class="section-number-2">1</span> 操作系统的目标与功能</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org4b710cd" class="outline-3">
<h3 id="org4b710cd"><span class="section-number-3">1.1</span> 定义</h3>
<div class="outline-text-3" id="text-1-1">
<ul class="org-ul">
<li>控制应用程序执行的程序</li>
<li>应用程序和计算机硬件之间的接口</li>
</ul>
</div>
</div>
<div id="outline-container-org2a9499d" class="outline-3">
<h3 id="org2a9499d"><span class="section-number-3">1.2</span> 目标</h3>
<div class="outline-text-3" id="text-1-2">
<ul class="org-ul">
<li>方便 (使用)</li>
<li>有效 (资源)</li>
<li>扩展能力</li>
</ul>
</div>
</div>
<div id="outline-container-org6e784eb" class="outline-3">
<h3 id="org6e784eb"><span class="section-number-3">1.3</span> 基本功能/提供的服务</h3>
<div class="outline-text-3" id="text-1-3">
<ul class="org-ul">
<li>程序开发</li>
<li>程序运行</li>
<li>I/O</li>
<li>文件 (对存储介质进行抽象)</li>
<li>系统访问 (资源保护/资源竞争)</li>
<li>错误检测和响应</li>
<li>记账</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orga0649c7" class="outline-2">
<h2 id="orga0649c7"><span class="section-number-2">2</span> 操作系统的发展过程</h2>
<div class="outline-text-2" id="text-2">
</div>
<div id="outline-container-org646c964" class="outline-3">
<h3 id="org646c964"><span class="section-number-3">2.1</span> 串行处理</h3>
</div>
<div id="outline-container-orgfc223c1" class="outline-3">
<h3 id="orgfc223c1"><span class="section-number-3">2.2</span> 简单批处理系统</h3>
</div>
<div id="outline-container-orgd0b69f7" class="outline-3">
<h3 id="orgd0b69f7"><span class="section-number-3">2.3</span> 多道批处理系统</h3>
<div class="outline-text-3" id="text-2-3">
</div>
<div id="outline-container-org3cfbea3" class="outline-4">
<h4 id="org3cfbea3"><span class="section-number-4">2.3.1</span> 并发 vs 并行</h4>
<div class="outline-text-4" id="text-2-3-1">
<ul class="org-ul">
<li>并发: 两个或多个事件在同一事件间隔内发生</li>
<li>并行: 两个或多个事件在同一时刻发生</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org08b6545" class="outline-3">
<h3 id="org08b6545"><span class="section-number-3">2.4</span> 分时系统</h3>
<div class="outline-text-3" id="text-2-4">
<p>
使用了和多道处理系统相似的技术, 但是目标是减少响应时间(一般来自用户).
一般是为了方便支持多个用户使用同一台计算机.
通常是: 多路, 独立, 及时, 交互的.
</p>
</div>
</div>
<div id="outline-container-org59c405f" class="outline-3">
<h3 id="org59c405f"><span class="section-number-3">2.5</span> 实时系统</h3>
<div class="outline-text-3" id="text-2-5">
<p>
目标是使系统能够及时的响应外部事件的请求. 能够在规定时间内开始或完成对该事件的处理.
</p>
</div>
</div>
</div>

<div id="outline-container-orgef02439" class="outline-2">
<h2 id="orgef02439"><span class="section-number-2">3</span> 操作系统的主要成就</h2>
<div class="outline-text-2" id="text-3">
<ul class="org-ul">
<li>进程</li>
<li>内存管理</li>
<li>信息保护和安全</li>
<li>调度和资源管理</li>
</ul>
</div>
</div>
<div id="outline-container-orgeb106f1" class="outline-2">
<h2 id="orgeb106f1"><span class="section-number-2">4</span> 操作系统的基本特征</h2>
<div class="outline-text-2" id="text-4">
</div>
<div id="outline-container-org51dc20b" class="outline-3">
<h3 id="org51dc20b"><span class="section-number-3">4.1</span> 并发性</h3>
<div class="outline-text-3" id="text-4-1">
<p>
最重要, 是其他特性的前提.
</p>
</div>
<div id="outline-container-org29fd8c7" class="outline-4">
<h4 id="org29fd8c7"><span class="section-number-4">4.1.1</span> 并发 vs 并行</h4>
<div class="outline-text-4" id="text-4-1-1">
<ul class="org-ul">
<li>并发: 两个或多个事件在同一事件间隔内发生</li>
<li>并行: 两个或多个事件在同一时刻发生</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org623ca02" class="outline-3">
<h3 id="org623ca02"><span class="section-number-3">4.2</span> 共享</h3>
<div class="outline-text-3" id="text-4-2">
<p>
系统资源可供多个并发执行的进程共同使用
</p>
</div>
</div>
<div id="outline-container-org045ca48" class="outline-3">
<h3 id="org045ca48"><span class="section-number-3">4.3</span> 虚拟性</h3>
<div class="outline-text-3" id="text-4-3">
<p>
对物理实体进程抽象
</p>
</div>
</div>
<div id="outline-container-orgcb24915" class="outline-3">
<h3 id="orgcb24915"><span class="section-number-3">4.4</span> 异步性(不确定性)</h3>
<div class="outline-text-3" id="text-4-4">
<p>
指程序执行过程中的异步性. 即, 我们不能确定:
</p>
<ul class="org-ul">
<li>何时执行</li>
<li>执行顺序</li>
<li>完成运行所需时间</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgc9b719a" class="outline-2">
<h2 id="orgc9b719a"><span class="section-number-2">5</span> 操作系统的体系结构</h2>
<div class="outline-text-2" id="text-5">
</div>
<div id="outline-container-org07ec66a" class="outline-3">
<h3 id="org07ec66a"><span class="section-number-3">5.1</span> 层次化</h3>
</div>
<div id="outline-container-org8ca043a" class="outline-3">
<h3 id="org8ca043a"><span class="section-number-3">5.2</span> 单体内核</h3>
</div>
<div id="outline-container-org4e4258d" class="outline-3">
<h3 id="org4e4258d"><span class="section-number-3">5.3</span> 微内核</h3>
</div>
<div id="outline-container-org2bd54cd" class="outline-3">
<h3 id="org2bd54cd"><span class="section-number-3">5.4</span> 模块化</h3>
<div class="outline-text-3" id="text-5-4">
</div>
</div>
</div>
<div id="outline-container-org259e92d" class="outline-2">
<h2 id="org259e92d"><span class="section-number-2">6</span> 进程定义</h2>
<div class="outline-text-2" id="text-6">
<p>
为了控制多道程序能够正确的并发执行, 所以引入进程.
</p>
</div>
<div id="outline-container-org8dfd77b" class="outline-3">
<h3 id="org8dfd77b"><span class="section-number-3">6.1</span> 典型的定义</h3>
<div class="outline-text-3" id="text-6-1">
<ul class="org-ul">
<li>一个正在执行的程序</li>
<li>能分配给处理器并由处理器执行的实体</li>
<li>{指令, 当前状态, 相关系统资源表征} (活动单元)</li>
</ul>
</div>
</div>
<div id="outline-container-org4291bf0" class="outline-3">
<h3 id="org4291bf0"><span class="section-number-3">6.2</span> 组成</h3>
<div class="outline-text-3" id="text-6-2">
<ul class="org-ul">
<li>程序代码</li>
<li>相关数据</li>
<li><p>
进程控制块
</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">项目</td>
</tr>

<tr>
<td class="org-left">标识符</td>
</tr>

<tr>
<td class="org-left">优先级</td>
</tr>

<tr>
<td class="org-left">程序计数器</td>
</tr>

<tr>
<td class="org-left">内存指针</td>
</tr>

<tr>
<td class="org-left">上下文数据</td>
</tr>

<tr>
<td class="org-left">IO状态</td>
</tr>

<tr>
<td class="org-left">记账信息</td>
</tr>
</tbody>
</table></li>
</ul>
</div>
</div>
<div id="outline-container-org77a257c" class="outline-3">
<h3 id="org77a257c"><span class="section-number-3">6.3</span> 基本特征</h3>
<div class="outline-text-3" id="text-6-3">
<ul class="org-ul">
<li>动态性 (本质)
存在生命周期</li>
<li>并发性 (重要)
可以和其他进程一起向前推进</li>
<li>独立性
各个进程地址空间相互独立</li>
<li>异步性</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgcecac23" class="outline-2">
<h2 id="orgcecac23"><span class="section-number-2">7</span> 进程状态</h2>
<div class="outline-text-2" id="text-7">
</div>
<div id="outline-container-orgdebd41c" class="outline-3">
<h3 id="orgdebd41c"><span class="section-number-3">7.1</span> 进程轨迹(trace)</h3>
<div class="outline-text-3" id="text-7-1">
<p>
列出进程执行的指令序列, 可以描述单个进程的行为, 
这样的序列称为 <code>进程轨迹(trace)</code>.
给出各个进程的trace的交替序列, 可以描述处理器的行为.
书上73页.
</p>
</div>
</div>
<div id="outline-container-org25d06a3" class="outline-3">
<h3 id="org25d06a3"><span class="section-number-3">7.2</span> 进程状态</h3>
<div class="outline-text-3" id="text-7-2">
</div>
<div id="outline-container-org8526a42" class="outline-4">
<h4 id="org8526a42"><span class="section-number-4">7.2.1</span> 三状态模型 {就绪, 执行, 阻塞}</h4>
<div class="outline-text-4" id="text-7-2-1">

<div class="figure">
<p><img src="pic/3-state.png" alt="3-state.png" />
</p>
</div>
</div>
</div>
<div id="outline-container-org7b78995" class="outline-4">
<h4 id="org7b78995"><span class="section-number-4">7.2.2</span> 五状态模型 {执行, 阻塞, 就绪, 新建, 终止}</h4>
<div class="outline-text-4" id="text-7-2-2">

<div class="figure">
<p><img src="pic/5-state.png" alt="5-state.png" />
</p>
</div>
<ul class="org-ul">
<li>新建:
<ul class="org-ul">
<li>已经有了 {进程标识符(PID), 管理进程所需的表格(PCB)}</li>
<li>还没有 {将程序加载到主存, 将数据加载到主存, 执行资格}</li>
</ul></li>
<li>终止:
<ul class="org-ul">
<li>没有了 {执行资格}</li>
<li>其他还在</li>
</ul></li>
</ul>
</div>
<ol class="org-ol">
<li><a id="org8e0cbb3"></a>阻塞队列<br />
<div class="outline-text-5" id="text-7-2-2-1">
<ul class="org-ul">
<li>{单阻塞, 单就绪} 队列</li>
<li>{多阻塞, 单就绪} 队列</li>
</ul>
</div>
</li>
</ol>
</div>
<div id="outline-container-orgcf89950" class="outline-4">
<h4 id="orgcf89950"><span class="section-number-4">7.2.3</span> 考虑挂起进程模型</h4>
<div class="outline-text-4" id="text-7-2-3">
</div>
<ol class="org-ol">
<li><a id="org8dbc311"></a>为什么要挂起<br />
<div class="outline-text-5" id="text-7-2-3-1">
<ul class="org-ul">
<li>内存资源紧张</li>
<li>希望能够容纳尽量多的进程, 防止所有进程都被阻塞的情况发生.</li>
</ul>
</div>
</li>
<li><a id="org9042989"></a>解决方案 &#x2013; 交换技术(Swapping)<br />
<div class="outline-text-5" id="text-7-2-3-2">
<p>
被交换到外存的进程, 状态变为 <code>挂起</code>.
于是{就绪, 阻塞}变为了{就绪, 阻塞, 就绪/挂起, 阻塞/挂起}
<img src="pic/suspend-state.png" alt="suspend-state.png" />
</p>
</div>
</li>
</ol>
</div>
</div>
</div>

<div id="outline-container-orgac61181" class="outline-2">
<h2 id="orgac61181"><span class="section-number-2">8</span> 进程描述</h2>
<div class="outline-text-2" id="text-8">
</div>
<div id="outline-container-orgd8c207e" class="outline-3">
<h3 id="orgd8c207e"><span class="section-number-3">8.1</span> 进程控制结构</h3>
<div class="outline-text-3" id="text-8-1">
</div>
<div id="outline-container-org31ee5c6" class="outline-4">
<h4 id="org31ee5c6"><span class="section-number-4">8.1.1</span> 进程的物理存在 &#x2013; 进程印像(Process Image)</h4>
<div class="outline-text-4" id="text-8-1-1">
<ul class="org-ul">
<li>程序段 + 数据段 + PCB + 栈</li>
</ul>
</div>
</div>
<div id="outline-container-org66c6577" class="outline-4">
<h4 id="org66c6577"><span class="section-number-4">8.1.2</span> PCB</h4>
<div class="outline-text-4" id="text-8-1-2">
</div>
<ol class="org-ol">
<li><a id="orge74c31a"></a>作用<br />
<div class="outline-text-5" id="text-8-1-2-1">
<ul class="org-ul">
<li>进程存在的唯一标志
PCB 常驻内存 (不会被换出)</li>
</ul>
</div>
</li>
<li><a id="org4926c66"></a>内容<br />
<div class="outline-text-5" id="text-8-1-2-2">
<ul class="org-ul">
<li>进程标识 {PID, 父进程PID, 用户ID}</li>
<li>处理机状态 {通用寄存器, 控制和状态寄存器, 栈指针}</li>
<li>进程控制信息 {调度和状态信息, 数据结构, 进程间通信, 存储管理, 资源所有权和使用情况}</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
<div id="outline-container-org8d65b54" class="outline-2">
<h2 id="org8d65b54"><span class="section-number-2">9</span> 内核功能和执行模式</h2>
<div class="outline-text-2" id="text-9">
</div>
<div id="outline-container-orge0dfde3" class="outline-3">
<h3 id="orge0dfde3"><span class="section-number-3">9.1</span> 内核功能</h3>
<div class="outline-text-3" id="text-9-1">
</div>
<div id="outline-container-org9714ac0" class="outline-4">
<h4 id="org9714ac0"><span class="section-number-4">9.1.1</span> 资源管理功能</h4>
<div class="outline-text-4" id="text-9-1-1">

<div class="figure">
<p><img src="pic/ziyuan.png" alt="ziyuan.png" />
</p>
</div>
</div>
</div>
<div id="outline-container-org8ffefee" class="outline-4">
<h4 id="org8ffefee"><span class="section-number-4">9.1.2</span> 支撑功能</h4>
<div class="outline-text-4" id="text-9-1-2">

<div class="figure">
<p><img src="pic/zhicheng.png" alt="zhicheng.png" />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org3fdcdcd" class="outline-3">
<h3 id="org3fdcdcd"><span class="section-number-3">9.2</span> 执行模式 {内核, 用户}</h3>
<div class="outline-text-3" id="text-9-2">
<ul class="org-ul">
<li>原因: 保护操作系统的数据结构不被破坏</li>
<li>实现: IA-64体系结构处理器中的PSR寄存器中存在指示执行模式的位</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org2c3678d" class="outline-2">
<h2 id="org2c3678d"><span class="section-number-2">10</span> 进程控制</h2>
<div class="outline-text-2" id="text-10">
</div>
<div id="outline-container-orgf6d9988" class="outline-3">
<h3 id="orgf6d9988"><span class="section-number-3">10.1</span> 内容</h3>
<div class="outline-text-3" id="text-10-1">
<ul class="org-ul">
<li>{创建, 撤销}</li>
<li>{阻塞, 唤醒}</li>
<li>{挂起, 激活}</li>
<li>切换@{时钟中断, I/O中断, 内存失效, 陷阱(当前指令出问题), 系统调用}</li>
</ul>
</div>
</div>
<div id="outline-container-orga9ca4e7" class="outline-3">
<h3 id="orga9ca4e7"><span class="section-number-3">10.2</span> 实现</h3>
<div class="outline-text-3" id="text-10-2">
<p>
进程控制由原语实现.
</p>
</div>
<div id="outline-container-org6fd33d3" class="outline-4">
<h4 id="org6fd33d3"><span class="section-number-4">10.2.1</span> 原语 (Primitive)</h4>
<div class="outline-text-4" id="text-10-2-1">
<p>
用于完成一定功能的过程. 
原子操作, 不允许被中断. 
</p>
</div>
</div>
</div>

<div id="outline-container-orge53b60e" class="outline-3">
<h3 id="orge53b60e"><span class="section-number-3">10.3</span> Unix 进程控制</h3>
<div class="outline-text-3" id="text-10-3">
<p>
<img src="pic/unix-state.png" alt="unix-state.png" />
<span class="underline">注意fork()</span>: 
</p>
<ul class="org-ul">
<li>fork()在子进程中返回0,</li>
<li>在父进程总返回子进程的pid</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org70727b2" class="outline-2">
<h2 id="org70727b2"><span class="section-number-2">11</span> 线程</h2>
<div class="outline-text-2" id="text-11">
</div>
<div id="outline-container-orgdf627d6" class="outline-3">
<h3 id="orgdf627d6"><span class="section-number-3">11.1</span> 提出</h3>
<div class="outline-text-3" id="text-11-1">
<p>
操作系统应该能够分别处理 <code>资源问题</code> 和 <code>调度问题</code>
</p>
</div>
<div id="outline-container-org1f8b293" class="outline-4">
<h4 id="org1f8b293"><span class="section-number-4">11.1.1</span> 区分</h4>
<div class="outline-text-4" id="text-11-1-1">
<ul class="org-ul">
<li>进程: 资源分配的基本单位</li>
<li>线程: 调度和分派的基本单位</li>
</ul>
</div>
</div>
<div id="outline-container-org1612631" class="outline-4">
<h4 id="org1612631"><span class="section-number-4">11.1.2</span> 一些术语</h4>
<div class="outline-text-4" id="text-11-1-2">
<p>
<i>多线程(multithreading): 指操作系统在 <span class="underline">单个</span> 进程内支持多个并发路径的能力</i>
<i>单线程方法:每个进程中只有一个线程在执行的方法</i>
</p>
</div>
</div>
<div id="outline-container-org2f18935" class="outline-4">
<h4 id="org2f18935"><span class="section-number-4">11.1.3</span> 例子</h4>
<div class="outline-text-4" id="text-11-1-3">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">单线程</td>
<td class="org-left">多线程</td>
</tr>

<tr>
<td class="org-left">单进程</td>
<td class="org-left">MS DOS</td>
<td class="org-left">Java 运行环境</td>
</tr>

<tr>
<td class="org-left">多进程</td>
<td class="org-left">传统Unix</td>
<td class="org-left">Windows, Solaris, 现代Unix</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="outline-container-orgbe207bb" class="outline-3">
<h3 id="orgbe207bb"><span class="section-number-3">11.2</span> 多线程环境, 用到的资源和保护</h3>
<div class="outline-text-3" id="text-11-2">
<ul class="org-ul">
<li>容纳进程映像的虚拟地址空间</li>
<li>对{CPU, 其他进程, 文件, I/O}的受保护访问.</li>
</ul>
</div>
</div>
<div id="outline-container-orgd43225d" class="outline-3">
<h3 id="orgd43225d"><span class="section-number-3">11.3</span> 每个线程的内容</h3>
<div class="outline-text-3" id="text-11-3">

<div class="figure">
<p><img src="pic/threadVSprocess.png" alt="threadVSprocess.png" />
</p>
</div>
<ul class="org-ul">
<li>{state(ready, block &#x2026;), context(register &#x2026;), stack{user, kernel}}</li>
<li>用于存放局部变量的静态存储空间</li>
<li>与进程内其他线程共享的内存和资源访问</li>
</ul>
</div>
</div>
<div id="outline-container-orga141cca" class="outline-3">
<h3 id="orga141cca"><span class="section-number-3">11.4</span> 线程状态变化的基本操作</h3>
<div class="outline-text-3" id="text-11-4">
<ul class="org-ul">
<li>派生</li>
<li>阻塞</li>
<li>接触阻塞</li>
<li>结束</li>
</ul>
</div>
</div>
<div id="outline-container-org753aa78" class="outline-3">
<h3 id="org753aa78"><span class="section-number-3">11.5</span> 线程的优点</h3>
<div class="outline-text-3" id="text-11-5">
<ul class="org-ul">
<li>创建时间小于进程</li>
<li>终止时间小于进程</li>
<li>切换时间小于进程</li>
<li>提高了不同执行程序间通信的效率</li>
</ul>
</div>
</div>
<div id="outline-container-org5db9c23" class="outline-3">
<h3 id="org5db9c23"><span class="section-number-3">11.6</span> 线程分类</h3>
<div class="outline-text-3" id="text-11-6">
</div>
<ol class="org-ol">
<li><a id="org86411d1"></a>用户级 (ULT: User-Level Thread)<br />
<ol class="org-ol">
<li><a id="org4483664"></a>优点<br />
<div class="outline-text-6" id="text-11-6-0-1-1">
<ul class="org-ul">
<li>可以运行在任何操作系统上</li>
<li>调度策略因应用程序而不同</li>
<li>线程切换不需要内核模式特权</li>
</ul>
</div>
</li>
<li><a id="org97fe486"></a>缺点<br />
<div class="outline-text-6" id="text-11-6-0-1-2">
<ul class="org-ul">
<li>一个线程阻塞, 则系统会阻塞这个进程下的所有线程 -&gt; 解决办法 {
  将可能产生阻塞的系统调用转化为一个非阻塞的系统调用:
  用一个(套管)例程来判断资源是否可用, 不可用则阻塞当前线程, 等下次轮到该线程的时候继续判断
}</li>
<li>不能利用多处理技术 -&gt; 解决办法 {
   将应用写出多进程
}</li>
</ul>
</div>
</li>
</ol>
</li>
<li><a id="orgee3b3b5"></a>内核级 (KLT: Kernel-Level Thread)<br />
<ol class="org-ol">
<li><a id="orgcf1833f"></a>优点<br />
<div class="outline-text-6" id="text-11-6-0-2-1">
<ul class="org-ul">
<li>内核可以把同一个进程内的多个线程调度到多处理器上</li>
<li>一个线程阻塞, 内核可以调度同一进程内的其他线程</li>
<li>内核例程本身也可以是多线程</li>
</ul>
</div>
</li>
<li><a id="orge534ba7"></a>缺点<br />
<div class="outline-text-6" id="text-11-6-0-2-2">
<ul class="org-ul">
<li>线程切换需要切换到内核模式</li>
</ul>
</div>
</li>
</ol>
</li>
<li><a id="org75455f8"></a>混合方法<br />
<div class="outline-text-5" id="text-11-6-0-3">
<ul class="org-ul">
<li>线程创建在用户空间完成</li>
<li>线程同步由应用程序完成</li>
<li>一个应用程序中的多个线程被映射到一些(小于等于用户线程数)内核线程上</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-orgb911a20" class="outline-2">
<h2 id="orgb911a20"><span class="section-number-2">12</span> 进程调度</h2>
<div class="outline-text-2" id="text-12">
</div>
<div id="outline-container-orgd78e730" class="outline-3">
<h3 id="orgd78e730"><span class="section-number-3">12.1</span> 背景</h3>
<div class="outline-text-3" id="text-12-1">
<p>
有多个进程(线程)竞争CPU, 需要选择下一个要运行的进程(线程)
</p>
</div>
<div id="outline-container-orgb93442d" class="outline-4">
<h4 id="orgb93442d"><span class="section-number-4">12.1.1</span> 定义</h4>
<div class="outline-text-4" id="text-12-1-1">
<p>
用来完成这部分工作的算法称为调度算法
</p>
</div>
</div>
</div>
<div id="outline-container-org08f248e" class="outline-3">
<h3 id="org08f248e"><span class="section-number-3">12.2</span> 类型</h3>
<div class="outline-text-3" id="text-12-2">

<div class="figure">
<p><img src="pic/long-mid-short.png" alt="long-mid-short.png" />
</p>
</div>
</div>
<div id="outline-container-org1565eb7" class="outline-4">
<h4 id="org1565eb7"><span class="section-number-4">12.2.1</span> 长程调度</h4>
</div>
<div id="outline-container-orgd1081fe" class="outline-4">
<h4 id="orgd1081fe"><span class="section-number-4">12.2.2</span> 中程调度</h4>
</div>
<div id="outline-container-org3cd7bcb" class="outline-4">
<h4 id="org3cd7bcb"><span class="section-number-4">12.2.3</span> 短程调度</h4>
</div>
</div>
<div id="outline-container-orgfa01e10" class="outline-3">
<h3 id="orgfa01e10"><span class="section-number-3">12.3</span> 概念</h3>
<div class="outline-text-3" id="text-12-3">
</div>
<div id="outline-container-orgf55b206" class="outline-4">
<h4 id="orgf55b206"><span class="section-number-4">12.3.1</span> 响应时间</h4>
<div class="outline-text-4" id="text-12-3-1">
<p>
提交一个请求, 到收到响应之间的时间间隔
</p>
</div>
</div>
<div id="outline-container-org47cf6f3" class="outline-4">
<h4 id="org47cf6f3"><span class="section-number-4">12.3.2</span> 周转时间(驻留时间)</h4>
<div class="outline-text-4" id="text-12-3-2">
<p>
一个进程从提交到完成之间的时间间隔, \(T_i\)
</p>
</div>
</div>
<div id="outline-container-org0cd550f" class="outline-4">
<h4 id="org0cd550f"><span class="section-number-4">12.3.3</span> 截止时间</h4>
<div class="outline-text-4" id="text-12-3-3">
<p>
某任务必须{开始/完成}的最迟时间
</p>
</div>
</div>
<div id="outline-container-org3bb4ea8" class="outline-4">
<h4 id="org3bb4ea8"><span class="section-number-4">12.3.4</span> 系统吞吐量</h4>
<div class="outline-text-4" id="text-12-3-4">
<p>
单位时间内, 系统完成的进程数 
</p>
</div>
</div>
<div id="outline-container-orga677863" class="outline-4">
<h4 id="orga677863"><span class="section-number-4">12.3.5</span> 处理器利用率</h4>
<div class="outline-text-4" id="text-12-3-5">
<p>
处理器处于忙状态的时间百分比
</p>
</div>
</div>
<div id="outline-container-org7b06877" class="outline-4">
<h4 id="org7b06877"><span class="section-number-4">12.3.6</span> 平均周转时间</h4>
<div class="outline-text-4" id="text-12-3-6">
<p>
\(T = \frac{1}{n}\sum_{i=1}^n T_i\)
</p>
</div>
</div>
<div id="outline-container-org43ecfe0" class="outline-4">
<h4 id="org43ecfe0"><span class="section-number-4">12.3.7</span> 带权周转时间</h4>
<div class="outline-text-4" id="text-12-3-7">
<p>
\(W_i = \frac{T_i}{T_{si}}\). \(T_{si}\) 表示系统为该进程提供服务的时间
</p>
</div>
</div>
<div id="outline-container-orgcfb1497" class="outline-4">
<h4 id="orgcfb1497"><span class="section-number-4">12.3.8</span> 平均带权周转时间</h4>
<div class="outline-text-4" id="text-12-3-8">
<p>
\(T = \frac{1}{n}\sum_{i=1}^n W_i\)
</p>
</div>
</div>
</div>
<div id="outline-container-org6c6f9ee" class="outline-3">
<h3 id="org6c6f9ee"><span class="section-number-3">12.4</span> 调度规则设计的出发点</h3>
<div class="outline-text-3" id="text-12-4">
</div>
<div id="outline-container-org44f20d3" class="outline-4">
<h4 id="org44f20d3"><span class="section-number-4">12.4.1</span> 分类</h4>
<div class="outline-text-4" id="text-12-4-1">
<ul class="org-ul">
<li>用户 &#x2013; 系统
<img src="pic/user-system.png" alt="user-system.png" /></li>
<li>性能相关的划分
<img src="pic/performance.png" alt="performance.png" /></li>
</ul>
</div>
</div>
<div id="outline-container-org991dcc7" class="outline-4">
<h4 id="org991dcc7"><span class="section-number-4">12.4.2</span> 通过分类来选择优化的目标函数</h4>
<div class="outline-text-4" id="text-12-4-2">

<div class="figure">
<p><img src="pic/object-function.png" alt="object-function.png" />
</p>
</div>
</div>
</div>
<div id="outline-container-org5bf8196" class="outline-4">
<h4 id="org5bf8196"><span class="section-number-4">12.4.3</span> 进程的决策模式</h4>
<div class="outline-text-4" id="text-12-4-3">
<ul class="org-ul">
<li>抢占</li>
<li>非抢占</li>
</ul>
</div>
</div>
<div id="outline-container-orgaad5926" class="outline-4">
<h4 id="orgaad5926"><span class="section-number-4">12.4.4</span> 调度选择函数</h4>
<div class="outline-text-4" id="text-12-4-4">

<div class="figure">
<p><img src="pic/selection-function.png" alt="selection-function.png" />
</p>
</div>
</div>
</div>
<div id="outline-container-org9462e46" class="outline-4">
<h4 id="org9462e46"><span class="section-number-4">12.4.5</span> 一些调度算法</h4>
<div class="outline-text-4" id="text-12-4-5">
<p>
<img src="pic/dispatch-algo.png" alt="dispatch-algo.png" />
<img src="pic/FB.png" alt="FB.png" />
</p>
</div>
<ol class="org-ol">
<li><a id="orgdf408f2"></a>注意事项<br />
<div class="outline-text-5" id="text-12-4-5-1">
<ul class="org-ul">
<li>图中标注的非抢占有两重意义
<ol class="org-ol">
<li>决策函数不会导致抢占</li>
<li>I/O繁忙型进程阻塞之后再返回, 也不能抢占(考虑FCFS).</li>
</ol></li>
</ul>
</div>
</li>
<li><a id="org1e39072"></a>评价中出现的一些定义<br />
<div class="outline-text-5" id="text-12-4-5-2">
<ul class="org-ul">
<li>有利: 带权周转时间 \(W_i\) 比其他进程大</li>
<li>不利: 带权周转时间 \(W_i\) 比其他进程小</li>
</ul>
</div>
</li>
<li><a id="org3a6a337"></a>评价<br />
<div class="outline-text-5" id="text-12-4-5-3">
<ul class="org-ul">
<li>FCFS (先来先服务)
<ul class="org-ul">
<li>{长进程有利, 短进程不利}</li>
<li>{CPU型有利, I/O型不利}</li>
</ul></li>
<li>RR (时间片轮转)
<ul class="org-ul">
<li>{CPU型有利, I/O型不利} -&gt; VRR算法</li>
</ul></li>
<li>SPN (短进程优先)
<ul class="org-ul">
<li>长进程饥饿</li>
</ul></li>
<li>SRT (剩余时间最短优先) &lt;- 在SPN的基础上增加了剥夺机制
<ul class="org-ul">
<li>长进程饥饿</li>
</ul></li>
<li>HRRN (响应比高者优先) &lt;- 综合了一下FCFS和SPN</li>
<li>FB (反馈法)
<ul class="org-ul">
<li>长进程饥饿</li>
</ul></li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-org4be7dac" class="outline-3">
<h3 id="org4be7dac"><span class="section-number-3">12.5</span> 实时系统与实时调度</h3>
<div class="outline-text-3" id="text-12-5">
</div>
<div id="outline-container-org33b4a47" class="outline-4">
<h4 id="org33b4a47"><span class="section-number-4">12.5.1</span> 定义</h4>
<div class="outline-text-4" id="text-12-5-1">

<div class="figure">
<p><img src="pic/shishidef.png" alt="shishidef.png" />
</p>
</div>
</div>
</div>
<div id="outline-container-orgf155ac4" class="outline-4">
<h4 id="orgf155ac4"><span class="section-number-4">12.5.2</span> 实时任务分类</h4>
<div class="outline-text-4" id="text-12-5-2">

<div class="figure">
<p><img src="pic/shishifenlei.png" alt="shishifenlei.png" />
</p>
</div>
</div>
</div>
<div id="outline-container-org8e85859" class="outline-4">
<h4 id="org8e85859"><span class="section-number-4">12.5.3</span> 实时操作系统特点</h4>
<div class="outline-text-4" id="text-12-5-3">
<p>
<img src="pic/shishitedian.png" alt="shishitedian.png" />
可确定, 可响应, 用户控制, 可靠, 失效弱化
</p>
</div>
</div>
<div id="outline-container-org39ecb8b" class="outline-4">
<h4 id="org39ecb8b"><span class="section-number-4">12.5.4</span> 实时进程的抢占方式</h4>
<div class="outline-text-4" id="text-12-5-4">
</div>
<ol class="org-ol">
<li><a id="orgd703edb"></a>基于时间片的轮转抢占式调度<br />
<div class="outline-text-5" id="text-12-5-4-1">

<div class="figure">
<p><img src="pic/rts1.png" alt="rts1.png" />
</p>
</div>
</div>
</li>
<li><a id="org6cbb382"></a>基于优先级的非抢占式调度<br />
<div class="outline-text-5" id="text-12-5-4-2">

<div class="figure">
<p><img src="pic/rts2.png" alt="rts2.png" />
</p>
</div>
</div>
</li>
<li><a id="orgcaf2b78"></a>基于优先级的抢占点抢占调度<br />
<div class="outline-text-5" id="text-12-5-4-3">

<div class="figure">
<p><img src="pic/rts3.png" alt="rts3.png" />
</p>
</div>
</div>
</li>
<li><a id="orgb4f1579"></a>立即抢占式调度<br />
<div class="outline-text-5" id="text-12-5-4-4">

<div class="figure">
<p><img src="pic/rts4.png" alt="rts4.png" />
</p>
</div>
</div>
</li>
</ol>
</div>
<div id="outline-container-org505c382" class="outline-4">
<h4 id="org505c382"><span class="section-number-4">12.5.5</span> 实时进程的调度方法分类</h4>
<div class="outline-text-4" id="text-12-5-5">
</div>
<ol class="org-ol">
<li><a id="orgbcd00f9"></a>静态表驱动调度法<br />
<div class="outline-text-5" id="text-12-5-5-1">
<ul class="org-ul">
<li>用于周期性实时任务</li>
<li>按照一些参数制定调度表, 然后按调度表执行调度</li>
<li>调度表不可修改 (后来的进程只能在之前的基础上制定调度表)</li>
</ul>
</div>
</li>
<li><a id="orgdbbd153"></a>静态优先级抢占调度法<br />
<div class="outline-text-5" id="text-12-5-5-2">
<ul class="org-ul">
<li>多用于非实时多道程序系统</li>
<li>利用一些参数确定优先级</li>
</ul>
</div>
</li>
<li><a id="orgcb27a9e"></a>基于动态规划的调度法 (动态调度表)<br />
<div class="outline-text-5" id="text-12-5-5-3">
<ul class="org-ul">
<li>系统为新到达的任务和老任务重算一张调度表</li>
</ul>
</div>
</li>
<li><a id="org57046a3"></a>动态尽力调度法 (也是基于优先级, 但是是动态的)<br />
<div class="outline-text-5" id="text-12-5-5-4">
<ul class="org-ul">
<li>广泛用于非周期性实时任务调度</li>
<li>总是尽最大努力尽早调度紧迫任务</li>
</ul>
</div>
</li>
</ol>
</div>
<div id="outline-container-orged56721" class="outline-4">
<h4 id="orged56721"><span class="section-number-4">12.5.6</span> 限期 (deadline) 调度</h4>
<div class="outline-text-4" id="text-12-5-6">
</div>
<ol class="org-ol">
<li><a id="orgf2a784c"></a>定义<br />
<div class="outline-text-5" id="text-12-5-6-1">

<div class="figure">
<p><img src="pic/dd-def.png" alt="dd-def.png" />
</p>
</div>
</div>
</li>
<li><a id="org170a9f5"></a>使用什么抢占方式<br />
<div class="outline-text-5" id="text-12-5-6-2">
<ul class="org-ul">
<li>启动期限明确: 用非抢占方式 (如基于优先级的非抢占式调度)
完成自身必要部分之后阻塞自己, 使其他进程能够启动</li>
<li>完成期限明确: 用抢占策略</li>
</ul>
</div>
</li>
<li><a id="org745460b"></a>使用什么调度方式<br />
<div class="outline-text-5" id="text-12-5-6-3">
<ul class="org-ul">
<li>具有 <span class="underline">完成期限</span> 的 <span class="underline">周期性</span> 实时任务 : EDF算法 (最早截止时间优先调度)</li>
<li>具有 <span class="underline">开始期限</span> 的 <span class="underline">非周期性</span> 实时任务: 
<ul class="org-ul">
<li>if 预先知道所有任务的开始截止时间: 
<ul class="org-ul">
<li>允许CPU空闲的EDF调度算法 (最早截止时间调度) &lt;- 可以从全局考虑, 先来的不一定先执行</li>
</ul></li>
</ul></li>
<li>速率单调调度算法 (Rate Monotonic Scheduling)
<ul class="org-ul">
<li>任务周期: 任务两次开始时间的差</li>
<li>任务速率: 任务周期的倒数</li>
<li>如何确定优先级: 周期短 -&gt; 优先级高</li>
<li>系统按优先级从高到低调度</li>
</ul></li>
</ul>
</div>
</li>
<li><a id="org053dcfe"></a>实时系统处理能力的限制<br />
<div class="outline-text-5" id="text-12-5-6-4">
<p>
假定系统有 \(m\) 个周期性硬实时任务, 任务 \(i\) 的处理时间为 \(C_i\), 周期为 \(P_i\).
则在单处理机的情况下, 必须满足下面的限制条件:
\[\sum_{i=1}^m \frac{C_i}{P_i} \leq 1 \]
</p>
</div>
</li>
<li><a id="org54aba00"></a>优先级反转<br />
<div class="outline-text-5" id="text-12-5-6-5">
<p>
一个高优先级的任务, 简洁被一个低优先级的任务所抢先, 使得两个任务的优先级被倒置.
<img src="pic/%E4%BC%98%E5%85%88%E7%BA%A7%E5%8F%8D%E8%BD%AC.png" alt="%E4%BC%98%E5%85%88%E7%BA%A7%E5%8F%8D%E8%BD%AC.png" />
<img src="pic/%E4%BC%98%E5%85%88%E7%BA%A7%E5%8F%8D%E8%BD%AC%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88.png" alt="%E4%BC%98%E5%85%88%E7%BA%A7%E5%8F%8D%E8%BD%AC%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88.png" />
</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div id="outline-container-org10efa76" class="outline-2">
<h2 id="org10efa76"><span class="section-number-2">13</span> 同步</h2>
<div class="outline-text-2" id="text-13">
</div>
<div id="outline-container-orgfee1e51" class="outline-3">
<h3 id="orgfee1e51"><span class="section-number-3">13.1</span> 相关术语</h3>
<div class="outline-text-3" id="text-13-1">
<p>
<img src="pic/%E5%B9%B6%E5%8F%91%E7%9B%B8%E5%85%B3%E6%9C%AF%E8%AF%AD.png" alt="%E5%B9%B6%E5%8F%91%E7%9B%B8%E5%85%B3%E6%9C%AF%E8%AF%AD.png" />
<img src="pic/%E5%B9%B6%E5%8F%91%E7%9B%B8%E5%85%B3%E6%9C%AF%E8%AF%AD(1).png" alt="%E5%B9%B6%E5%8F%91%E7%9B%B8%E5%85%B3%E6%9C%AF%E8%AF%AD(1).png" />
</p>
</div>
</div>
<div id="outline-container-org90da7cc" class="outline-3">
<h3 id="org90da7cc"><span class="section-number-3">13.2</span> 进程间的关系</h3>
<div class="outline-text-3" id="text-13-2">
<ul class="org-ul">
<li>竞争</li>
<li>通过共享合作</li>
<li>通过通信合作</li>
</ul>
</div>
</div>
<div id="outline-container-orge981b32" class="outline-3">
<h3 id="orge981b32"><span class="section-number-3">13.3</span> 互斥的要求 (访问临界区的原则)</h3>
<div class="outline-text-3" id="text-13-3">
<ul class="org-ul">
<li>空闲让进: 如临界区空闲, 则有进程申请就立即进入</li>
<li>忙则等待: 每次只允许一个进程处于临界区</li>
<li>有限等待: 保证进程在有限的时间内能够进入临界区</li>
<li>让权等待: 进程在临界区不能长时间阻塞等待某事件</li>
</ul>
</div>
</div>
<div id="outline-container-org1769e4d" class="outline-3">
<h3 id="org1769e4d"><span class="section-number-3">13.4</span> 互斥: 软件方法</h3>
<div class="outline-text-3" id="text-13-4">
<ul class="org-ul">
<li>初步设想: 轮换使用临界区 -&gt; 慢</li>
<li>第一次改进: 设置临界区状态标志 -&gt; 不互斥</li>
<li>第二次改进: 预先表明进入临界区的态度 -&gt; 互斥, 但死锁</li>
<li>第三次改进: 预先表明进入临界区的态度+谦让 -&gt; 互斥, 不死锁, 但可能一都在谦让(费时)</li>
<li>Dekker: 给一个序号(回合号), 每个进程可以在特定的回合不谦让</li>
<li>Peterson: 和Dekker等价, 但是更简洁了</li>
</ul>
</div>
<div id="outline-container-orge0e0a49" class="outline-4">
<h4 id="orge0e0a49"><span class="section-number-4">13.4.1</span> 评价</h4>
<div class="outline-text-4" id="text-13-4-1">
<ul class="org-ul">
<li>不能解决忙等现象</li>
<li>难实现多个进程互斥</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-org4fb6e44" class="outline-3">
<h3 id="org4fb6e44"><span class="section-number-3">13.5</span> 互斥: 硬件方法</h3>
<div class="outline-text-3" id="text-13-5">
</div>
<div id="outline-container-org3b6c71d" class="outline-4">
<h4 id="org3b6c71d"><span class="section-number-4">13.5.1</span> 屏蔽中断</h4>
<div class="outline-text-4" id="text-13-5-1">
<ul class="org-ul">
<li>执行效率下降</li>
<li>无法工作在多处理器环境</li>
</ul>
</div>
</div>
<div id="outline-container-org833642f" class="outline-4">
<h4 id="org833642f"><span class="section-number-4">13.5.2</span> 机器专用指令</h4>
<div class="outline-text-4" id="text-13-5-2">
<ul class="org-ul">
<li>exchange</li>
<li>compare&amp;swap</li>
</ul>
</div>
<ol class="org-ol">
<li><a id="orgd960592"></a>评价:<br />
<div class="outline-text-5" id="text-13-5-2-1">
<ul class="org-ul">
<li>优点: {支持多处理机, 简单易证明, 支持多临界区}</li>
<li>缺点: 可能{忙等, 饥饿, 死锁}</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-org5b53a63" class="outline-3">
<h3 id="org5b53a63"><span class="section-number-3">13.6</span> 信号量</h3>
<div class="outline-text-3" id="text-13-6">
</div>
<div id="outline-container-org11b378f" class="outline-4">
<h4 id="org11b378f"><span class="section-number-4">13.6.1</span> 实现</h4>
<div class="outline-text-4" id="text-13-6-1">

<div class="figure">
<p><img src="pic/%E4%BF%A1%E5%8F%B7%E9%87%8F%E5%AE%9E%E7%8E%B0.png" alt="%E4%BF%A1%E5%8F%B7%E9%87%8F%E5%AE%9E%E7%8E%B0.png" />
</p>
</div>
</div>
</div>
<div id="outline-container-org10b7b14" class="outline-4">
<h4 id="org10b7b14"><span class="section-number-4">13.6.2</span> 常见模型</h4>
<div class="outline-text-4" id="text-13-6-2">
</div>
<ol class="org-ol">
<li><a id="orgd85b16c"></a>生产者/消费者<br />
<div class="outline-text-5" id="text-13-6-2-1">

<div class="figure">
<p><img src="pic/%E7%94%9F%E4%BA%A7%E8%80%85%E6%B6%88%E8%B4%B9%E8%80%85.png" alt="%E7%94%9F%E4%BA%A7%E8%80%85%E6%B6%88%E8%B4%B9%E8%80%85.png" />
</p>
</div>
</div>
</li>
<li><a id="org20460b3"></a>读者/写者<br />
<div class="outline-text-5" id="text-13-6-2-2">

<div class="figure">
<p><img src="pic/%E8%AF%BB%E8%80%85%E5%86%99%E8%80%85.png" alt="%E8%AF%BB%E8%80%85%E5%86%99%E8%80%85.png" />
</p>
</div>
<ul class="org-ul">
<li>读者优先
<img src="pic/%E8%AF%BB%E8%80%85%E4%BC%98%E5%85%88.png" alt="%E8%AF%BB%E8%80%85%E4%BC%98%E5%85%88.png" /></li>
<li>公平优先
<img src="pic/%E5%85%AC%E5%B9%B3%E4%BC%98%E5%85%88.png" alt="%E5%85%AC%E5%B9%B3%E4%BC%98%E5%85%88.png" /></li>
<li>写者优先
<img src="pic/%E5%86%99%E8%80%85%E4%BC%98%E5%85%88.png" alt="%E5%86%99%E8%80%85%E4%BC%98%E5%85%88.png" /></li>
<li>写者优先改进
<img src="pic/%E5%86%99%E8%80%85%E4%BC%98%E5%85%88%E6%94%B9%E8%BF%9B.png" alt="%E5%86%99%E8%80%85%E4%BC%98%E5%85%88%E6%94%B9%E8%BF%9B.png" /></li>
</ul>
</div>
</li>
<li><a id="orga92860f"></a>两种模型比较<br />
<div class="outline-text-5" id="text-13-6-2-3">

<div class="figure">
<p><img src="pic/%E4%B8%A4%E7%A7%8D%E6%A8%A1%E5%9E%8B%E6%AF%94%E8%BE%83.png" alt="%E4%B8%A4%E7%A7%8D%E6%A8%A1%E5%9E%8B%E6%AF%94%E8%BE%83.png" />
</p>
</div>
</div>
</li>
</ol>
</div>
<div id="outline-container-org5d2bb50" class="outline-4">
<h4 id="org5d2bb50"><span class="section-number-4">13.6.3</span> 管程</h4>
<div class="outline-text-4" id="text-13-6-3">
<p>
有自己局部变量(static), 每个时刻只能有一个进程在管程中.
<i>感觉管程有点像一个类, 但是保证一次只能一个进程在调接口</i>
</p>
</div>
</div>
<div id="outline-container-orgfa9167c" class="outline-4">
<h4 id="orgfa9167c"><span class="section-number-4">13.6.4</span> 消息传递</h4>
<div class="outline-text-4" id="text-13-6-4">
</div>
<ol class="org-ol">
<li><a id="org1df562a"></a>实现<br />
<div class="outline-text-5" id="text-13-6-4-1">
<ul class="org-ul">
<li>send 原语</li>
<li>receive 原语</li>
</ul>
</div>
</li>
<li><a id="org534d019"></a>三种同步方式<br />
<div class="outline-text-5" id="text-13-6-4-2">
<ul class="org-ul">
<li>阻塞发送, 阻塞接受</li>
<li>不阻塞发送, 阻塞接受</li>
<li>不阻塞发送, 不阻塞接受</li>
</ul>
</div>
</li>
<li><a id="org990087b"></a>消息寻址方式<br />
<div class="outline-text-5" id="text-13-6-4-3">
<ul class="org-ul">
<li>直接</li>
<li>间接 (利用一个公共的数据结构 &#x2013; 信箱)
<img src="pic/%E4%BF%A1%E7%AE%B1.png" alt="%E4%BF%A1%E7%AE%B1.png" />
举例:
<img src="pic/%E4%BF%A1%E7%AE%B1%E7%94%A8%E6%B3%95%E4%B8%BE%E4%BE%8B.png" alt="%E4%BF%A1%E7%AE%B1%E7%94%A8%E6%B3%95%E4%B8%BE%E4%BE%8B.png" /></li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: 陈小羽</p>
<p class="date">Created: 2019-04-24 Wed 21:48</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
